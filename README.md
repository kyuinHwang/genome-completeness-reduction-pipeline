# Simulated Genome Reduction Tool Based on Completeness Threshold

This repository provides scripts to simulate genome incompleteness by randomly reducing annotated genes from microbial genomes to a target completeness level.
Reduced genomes are intended to mimic MAG/SAG-level completeness for benchmarking purposes.

## Key Features
- Combines Prokka .gff and KEGG .ko annotation files into a unified input format.
- Randomly reduces genes to simulate arbitrary completeness levels.
- Outputs reduced gene sets (.ko annotation files) compatible with downstream functional annotation pipelines.

## Installation
This pipeline requires Python 3.10 or higher.
No additional Python packages are strictly required, as the pipeline mainly uses standard libraries.

Clone the repository:

```bash
git clone https://github.com/kyuinHwang/genome-completeness-reduction-pipeline.git
cd genome-completeness-reduction-pipeline
```

Cloning the repository and setting up the pipeline takes only a few seconds on a standard system.

## System Requirements & Notes

**Tested on:** Ubuntu 24.04 (Docker container on macOS) with Python 3.12.7 and standard library only.

**System requirements:** No special hardware is required. The pipeline runs on a standard laptop environment

## Usage & Scripts

Step 1. Combine .gff and .ko into a united TSV
``` bash
python scripts/join_gff_ko.py \
  --gff examples/Gff/GB_GCA_016462095.1.gff \
  --ko examples/KO/GB_GCA_016462095.1.ko \
  --output_tsv examples/GB_GCA_016462095.1.gff.ko.tsv
```

Step 2. Simulate genome reduction (e.g., reduce a genome with 89.8% completeness to 48.3%)
``` bash
python ./scripts/reduce_genome_by_completeness.py \
  --input_tsv=./examples/GB_GCA_016462095.1.gff.ko.tsv \
  --output=./GB_GCA_016462095.1.reduce.ko \
  --original_completeness=89.8  \
  --target_completeness=48.3
```

## Input
GFF file (.gff) : Gene annotation file generated by Prokka.

KO file (.ko) : File including KO annotations of queried genome. Genome.ko is a tab-delimited file listing each gene's locus tag and its corresponding KO assignment, one per line (e.g., EXCAFAC_00031 K00302). This file can be generated through BLAST searches as described in our publication (see Reference section below), or via the [KEGG annotation web server](https://www.kegg.jp/kegg/annotation/).

## Output
The pipeline generates a reduced KO profile file for each genome, reflecting the specified completeness threshold.

- ***KO file (.ko)*** : A tab-delimited file listing the retained gene locus tags and their corresponding KO annotations after downsampling.

Example output files can be found in './examples/reduced/.'

## Files
./examples directory contains GFF files and KO files for three public genomes of p__Actinomycetota. You can also run all examples at once using 
``` bash
bash examples/cmd.sh
```

## License

This repository is released under the MIT License.

## Contact
If you encounter a problem or have a question, please open an issue on this repository:
ðŸ‘‰ [Submit an issue](https://github.com/kyuinHwang/genome-completeness-reduction-pipeline/issues)

For direct inquiries, you may contact the maintainer at: rbdls77@gmail.com

## Reference

This pipeline was developed as part of a research project on single-cell genomics analysis of Mercer Subglacial Lake in Antarctica.

The preprint is available on Research Square:
https://www.researchsquare.com/article/rs-4392950/v1

(This link will be updated upon journal publication.)

This tool was originally used to test the robustness of metabolic potential inference tools (e.g., [ko2pathway](https://github.com/kyuinHwang/ko2pathway)) on low-completeness draft genomes (e.g., MAGs, SAGs).

## Note on Random Seed:
By default, the genome reduction uses a fixed random seed (--seed 12345) to ensure reproducibility. However, if you're performing repeated runs (e.g., 100 replicates for statistical comparison), you should change the seed in each run to avoid identical results.

Parts of this README were written or revised with the help of AI to enhance clarity and precision.
